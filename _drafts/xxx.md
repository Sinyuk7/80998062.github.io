# æˆ‘åªæ˜¯å°å®‰å“ğŸ˜¢

> å…¥å‘ä¸€å¹´ è®°ä¸€ç‚¹æµæ°´è´¦      



å­¦Androidæœ‰ä¸€å¹´äº†å§,è¿™ä¸€å¹´ä¸‹æ¥,ä¸çŸ¥é“è¸©äº†å¤šå°‘å‘,å¹´å…³äº†,è®°è®°æµæ°´è´¦.



> æ’å›¾ github

å‰å‰ååæƒ³å†™è¿‡ä¸€äº›ä¸œè¥¿....ç»“æœéƒ½æ”¾å¼ƒäº†...

ä¸€äº›å› ä¸ºå¤–åŠ›å› ç´  ä¸€äº›æ˜¯å› ä¸ºæ²¡ä»€ä¹ˆæ„æ€...

å†™appå¤§éƒ¨åˆ†è¿˜æ˜¯ç´¯æ­»ç´¯æ´»çš„åœ¨å†™è½®å­å’Œ æ„Ÿè§‰æå‡ä¸æ˜¯å¾ˆå¤§

ä½†æ˜¯å¤šçœ‹çœ‹åˆ«äººçš„ä»£ç å’Œæ–‡ç« æœ‰ç”¨



å‰åå¾…äº†ä¸¤ä¸ªå…¬å¸,éƒ½æ˜¯å°è§„æ¨¡çš„åˆ›ä¸šå…¬å¸

è‡³ä»Šéƒ½è¿˜æ˜¯å‡ ä¸ªäºº(ç°åœ¨æ˜¯ä¸€ä¸ªäºº)å¼€å‘...

æ²¡ä½“éªŒè¿‡å¤§è§„æ¨¡é¡¹ç›®çš„å¼€å‘æ¨¡å¼(æ’ä»¶åŒ–ä»€ä¹ˆçš„

æ²¡æ€ä¹ˆå†™è¿‡è§„èŒƒç‚¹çš„æ–‡æ¡£

æ²¡æœ‰ä»€ä¹ˆcode review

æ²¡æœ‰äººæ¥æµ‹è¯•



ä»¥å‰æˆ‘éƒ½ä¸æ€ä¹ˆå–œæ¬¢ç”¨fragment,ç°åœ¨æˆ‘å¼€å§‹åœ¨é¡¹ç›®é‡Œé¢å¤§é‡çš„ä½¿ç”¨fragment

åœ¨å°è¯•è¿‡å°è£…ä¸€äº›åŸºç±»æ¥å¤ç”¨ä¹‹å

> æ¯”å¦‚ä¸€ä¸ªæ˜¾ç¤ºåˆ—è¡¨çš„`Fragment`åŸºæœ¬å°±æ˜¯ä¼ å…¥ä¸€ä¸ªViewModelå’Œä¸€ä¸ªItemçš„å¸ƒå±€æ–‡ä»¶å°±å¯ä»¥äº†

å‘ç°è™½ç„¶è¿™æ ·çš„åšæ³•è™½ç„¶å¤ç”¨äº†å¤§é‡ä»£ç ,ä½†æ˜¯è€¦åˆåº¦è¿˜æ˜¯å¾ˆé«˜

æ¯æ¬¡äº§å“ç»ç†ä¸€å¼€å£,æˆ‘éƒ½æ„Ÿè§‰è‡ªå·±çš„ä»£ç æ˜¯ä¸€æ‘ŠğŸ¶å±



ä¹‹å‰è‡ªå·±å†™ä¸œè¥¿çš„æ—¶å€™è¿˜æ„Ÿè§‰ä¸åˆ°MVPçš„å¥½å¤„ 

æ‰€ä»¥ç°åœ¨åœ¨å…¬å¸çš„é¡¹ç›®é‡Œé¢æ²¡æœ‰ç”¨,ç°åœ¨æƒ³æƒ³çœŸæ˜¯åæ‚”



>  æ„Ÿè§‰androidå¼€å‘çœŸæ˜¯éš¾,ç›¸æ¯”iOS
>
> æ¯æ¬¡æˆ‘æ”¹æ­»æ”¹æ´»å…¬å¸çš„iOSéƒ½åªè¦éšä¾¿ææ



å¯èƒ½æˆ‘èƒ½é€šè¿‡å¾ˆå¥½çš„å°è£…æ¥è§£å†³Activity/Fragmentè¿‡é‡çš„é—®é¢˜,ä½†æ˜¯é¡¹ç›®è¿˜æ˜¯å¾ˆéš¾ç»´æŠ¤

å°¤å…¶æ˜¯å½“éœ€æ±‚ä¸€ç›´åœ¨æ”¹å˜,æ–°åŠŸèƒ½ä¸æ–­åœ¨è¿­ä»£

é¡¹ç›®çš„å†å²è´Ÿæ‹…è¶Šæ¥è¶Šå¤§(KPIå‹åŠ›å€’æ˜¯æ²¡ç”¨â€¦æ„Ÿè§‰æˆ‘ä»¬çš„ç”¨æˆ·éƒ½æ˜¯iOSäººç¾¤ğŸ‘…)

æ¯éš”ä¸€æ®µæ—¶é—´çœ‹è‡ªå·±çš„ä»£ç ,æˆ‘éƒ½æ„Ÿè§‰æ˜¯åœ¨å±å±±é‡Œé¢ç¿»æ»š...

æ‰€ä»¥V/Påˆ†ç¦»è²Œä¼¼æˆä¸ºäº†ä¸€ç§å¿…éœ€...

å°½ç®¡å„ç§æ¶æ„å‰æœŸæ€»æœ‰ä¸€äº›é¢å¤–çš„å·¥ä½œ,ä½†æ˜¯ä¹‹åçš„å¼€å‘ä¼šå˜å¾—å¾ˆè½»æ¾

åœ¨Appä½“ç§¯ä¸æ–­å¢å¤§çš„æ—¶å€™,è®©é¡¹ç›®ç»†åˆ†ä¸‹æ¥çš„codebaseå°½é‡å°



ç„¶åæƒ³åˆ†äº«æœ€è¿‘æœ‰å…³cleanæ¶æ„çš„ä¸€äº›å°è¯• ç„¶åæç‚¹é—®é¢˜(å¤§å®¶ä¸€èµ·æ¢è®¨ä¸‹

> ç»™å¤§ä½¬é€’ğŸµ



## å‰è¨€

æœ€è¿‘äº†è§£å¹¶å°è¯•äº†ä¸€ä¸‹cleanæ¶æ„ å‘ç°å®ƒçœŸçš„å¾ˆç»™åŠ›

å¥½åæ‚”è‡ªå·±æ²¡æœ‰æ—©ç‚¹ç†Ÿæ‚‰å®ƒå¹¶æŠ•å…¥é¡¹ç›®

Cleanæ¶æ„å¯ä»¥ä½¿ä½ çš„ä»£ç æœ‰å¦‚ä¸‹ç‰¹æ€§:

- ç‹¬ç«‹äºæ¶æ„
- æ˜“äºæµ‹è¯•
- ç‹¬ç«‹äºUI
- ç‹¬ç«‹äºæ•°æ®åº“
- ç‹¬ç«‹äºä»»ä½•å¤–éƒ¨ç±»åº“


å¦‚æœä½ ä¸äº†è§£cleanæ¶æ„ å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ç¯‡æ–‡ç« :

https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html

å…³äºMV

å¯ä»¥çœ‹çœ‹å¤§å¸…çš„æ–‡ç« 

> é©¬å…‹å®…å§æ§½

æˆ‘è®²çš„è‚¯å®šä¹Ÿæ²¡æœ‰å®ƒå¥½...

> ç»™å¤§ä½¬åœ°æ’



## å¼€å§‹

ç®—äº†,å°‘ä¸€ç‚¹å¥—è·¯,æˆ‘ä»¬ç›´æ¥æ¥å°±è¿™ä»£ç çœ‹çœ‹:

è¯•ç€å†™äº†ä¸€ä¸ªdemo:

> æœ¬æ¥æƒ³åšä¸€ä¸ªtubmlræ ·å­çš„weibo, å†™ç€å†™ç€å‘ç°æ¸£æµªå¯¹ç¬¬ä¸‰æ”¾å¼€å‘è€…çš„é™åˆ¶å¤ªå¤šäº†.
>
> å‘ç°æˆä¸ªæƒè¿˜è¦è®¤è¯,è¿˜è¦ç”³è¯·ä¸€ä¸ªè“Vçš„å¾®åšâ€¦æˆ‘æ„Ÿè§‰å¾ˆéš¾å—

è™½ç„¶åªå†™äº†ä¸€ç‚¹ç‚¹,ä½†æ˜¯cleanæ¶æ„çš„æ ·å­æ„Ÿè§‰æœ‰äº†(æˆ‘æ˜¯è¿™ä¹ˆè§‰å¾—

> å®³ç¾

æ‰€ä»¥å°±é’ˆå¯¹è‡ªå·±çš„é¡¹ç›®æ¥è®²è®²

è¿™å¼ å›¾ä½ è‚¯å®šè§è¿‡...

> ä¸Šå›¾ 



 å…¶å®æ›´ç›´è§‚çš„,æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹3ä¸ªmoduleä¹‹é—´çš„ä¾èµ–:

- data(æ•°æ®å±‚

```groovy
apply plugin: 'java'
def cfg = rootProject.ext;
dependencies {
    // ReactiveX
    compile cfg.dependencies["rxjava"]
    // Square
    compile cfg.dependencies["retrofit"]
    compile cfg.dependencies["converter-gson"]
    compile cfg.dependencies["adapter-rxjava"]
    compile cfg.dependencies["logging-interceptor"]
    compile cfg.dependencies["dagger"]
}
```



- usecase(ç”¨ä¾‹å±‚ å½“ç„¶ä½ å«domainä¹Ÿè¡Œ

```groovy
apply plugin: 'java'
dependencies {
    compile project(':data')
}
```

> dataå’Œusecaseå±‚éƒ½åº”è¯¥æ˜¯javaä»£ç ,è·Ÿandroid frameworkæ— å…³

- app(å°±æ˜¯æˆ‘ä»¬å¹³æ—¶å†™çš„app module

```groovy
  dependencies {
        compile fileTree(include: ['*.jar'], dir: 'libs')
        // skip
        compile project(':usecase')
  }
```

ä½ ä»¬æ„Ÿå—ä¸€ä¸‹:

ç„¶åå°±åŸºæœ¬èƒ½ç†è§£ç”¨ä¾‹å±‚ä»æ•°æ®å±‚è·å–æ•°æ®,ç„¶ååœ¨è¿™é‡Œè¿›è¡Œå¤„ç†

> å½“ç„¶æˆ‘å‘ç°ä¸€èˆ¬çš„é¡¹ç›®æ ¹æœ¬æ²¡æœ‰ä»€ä¹ˆä¸šåŠ¡é€»è¾‘å¯ä»¥åœ¨è¿™é‡Œå†™çš„...

è§†å›¾å±‚ä»ç”¨ä¾‹å±‚è·å–æ•°æ®ç„¶åæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Š



ç„¶åè®²ä¸€ä¸‹å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿

---

## Standing

**dataå±‚**

![http://west.cdn.gui-quan.com/media/upload/315e592927c8e8f62822e9e7cfcde5912d0793e5](data)



**entities:**

 å®ä½“ç±»(æœ€åŸå§‹çš„æ•°æ®,ä¸è¯¥éšç€ä¸šåŠ¡é€»è¾‘è€Œæ”¹å˜



**wrapper:**

å¯¹å®ä½“ç±»çš„ä¸€å±‚å°è£…,åœ¨è¿™é‡Œä½ å¯èƒ½è¦è‡ªå·±åŠ ä¸€äº›ä¸œè¥¿:æ¯”å¦‚:

- å¤„ç†timestamp,è½¬æ¢è¾“å‡ºæœ¬åœ°æ—¶é—´
- ä¸€äº›é¢å¤–çš„å‚æ•°,æ¯”å¦‚æ•°æ®è¾¹ç•Œçš„éªŒè¯ç­‰ç­‰

> å½“ç„¶è¿™äº›ä½ ä¹Ÿå¯ä»¥æ”¾åœ¨Viewå±‚çš„ViewModelé‡Œé¢
>
> ä½†æ˜¯æ„Ÿè§‰æ”¾è¿™é‡Œæ¯”è¾ƒæ¸…æ™°

**remote:**

é¡¾åæ€ä¹‰å˜›,è¿™å°±æ˜¯RemoteDataSource,åœ¨è¿™é‡Œé…ç½®å’Œå°è£…äº†(å¯¹äºæˆ‘æ¥è¯´)OkHttpå’ŒRetrofitçš„æ¥å£

**utils:**

- è‡ªå®šä¹‰äº†ä¸€äº›`transformer`,æ¯”å¦‚åˆ‡æ¢çº¿ç¨‹å’Œå…¨å±€çš„é”™è¯¯å¤„ç†
- ç½‘ç»œè¯·æ±‚çš„Interceptor
- å…¶ä»–ä¹±ä¸ƒå…«ç³Ÿçš„







å½“æ—¶è¿™æ ·å†™äº†æˆ‘å°±æ„Ÿè§‰ç‰¹åˆ«é…·ç‚«(è¯´å‡ºæ¥åˆ«ç¬‘æˆ‘...

å› ä¸ºå¯ä»¥åœ¨è¿™é‡Œç›´æ¥ç”¨ä¸€ä¸ªjavaç±»æ¥æµ‹è¯•api,è€Œä¸æ˜¯ç¼–è¯‘æ•´ä¸ªé¡¹ç›®...

æ¯æ¬¡å«æˆ‘ä»¬pythonè¿‡æ¥çœ‹logcatçš„æ—¶å€™ = = ä»–éƒ½ä¼šåœ¨æ—è¾¹å‘ç‰¢éªš: androidç¼–è¯‘æ€ä¹ˆä¼šè¿™ä¹ˆæ…¢....

>  å§æ§½æˆ‘ä¹Ÿä¸æƒ³å•Š

å½“ç„¶ä½ ä¼šè¯´ç”¨postmanä¸å°±å¥½äº†...

ä½†æ˜¯é…ç½®äº†OkHttpå’ŒRetrofitä¹‹å,å°±èƒ½æœ‰ä¸€ä¸ªAppè¿è¡Œæ—¶çš„ç¯å¢ƒå˜›...



**usecaseå±‚**

> ç”¨ä¾‹å±‚å°±æ¯”è¾ƒç®€å•äº†...å› ä¸ºä¸€èˆ¬çš„åº”ç”¨éƒ½æ²¡æœ‰ä»€ä¹ˆä¸šåŠ¡é€»è¾‘

ä¸¾ä¸ªğŸŒ°

æˆ‘è¦ä»ä¸€ä¸ªä»serverç«¯è·å–å¾®åš(status)æ˜¾ç¤ºåˆ°timelineåˆ—è¡¨ä¸Š

é¦–å…ˆæˆ‘æœ‰ä¸€ä¸ª`Usecase`çš„æ¥å£è¦ç»§æ‰¿(`<T>`æ˜¯ç½‘ç»œè¯·æ±‚è¿”å›çš„æ•°æ®ç±»å‹

```java
public abstract class Usecase<T> {
    protected abstract Observable<T> buildObservable();
}
```

å…·ä½“ä»£ç :

```java
public class GetTimelineUsecase extends Usecase<Timeline> {
    private final RemoteRepository mRepository;
    private final SchedulerTransformer<Timeline> mSchedulerTransformer;
    private int page = 1;
    @Named("uid")
    private long uid;
    @Named("timeline_type")
    private String timeline_type;

    @Inject
    GetTimelineUsecase(RemoteRepository repository,
                       @Named("io_main") SchedulerTransformer schedulerTransformer,
                       @Named("timeline_type") String timeline_type,
                       @Named("uid") long uid) {
        mRepository = repository;
        mSchedulerTransformer = schedulerTransformer;
        this.uid = uid;
        this.timeline_type = timeline_type;
    }
}
```

åœ¨æ„é€ å‡½æ•°é‡Œé¢æˆ‘ä»¬æ³¨å…¥äº†:

- æ ¹æ®é¡µé¢é€»è¾‘ç›¸å…³çš„å‚æ•°(`timeline_type`,`uid`)

- è·Ÿandroid frameworkç›¸å…³çš„ä¸œè¥¿(æ¯”å¦‚` AndroidSchedulers.mainThread()`

  > å› ä¸ºè¿™ä¸€å±‚æ˜¯`apply plugin: 'java'`å˜›~

  â€‹

ç„¶åæˆ‘éœ€è¦æœ‰:

- RemoteRepository(æº,è¿”å›æ•°æ®

- SchedulerTransformer(åˆ‡æ¢çº¿ç¨‹,æ¯”å¦‚IOå’ŒUIçº¿ç¨‹ä¹‹é—´

  > è¿™é‡Œæˆ‘ç›´æ¥æ³¨å…¥ä¸€ä¸ªtransformer...å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ³¨å…¥ä¸åŒçš„`thread`

  â€‹


- timeline_type,uid(æ¥å£çš„å‚æ•°

  > é’ˆå¯¹è¿”å›ç›¸åŒæ•°æ®ç±»å‹çš„æ¥å£ æˆ‘ä»¬å¯ä»¥å°è£…åœ¨ä¸€ä¸ªç”¨ä¾‹é‡Œé¢




æˆ‘åœ¨`buildObservable()`ä¸­æ ¹æ®`timeline_type`å’Œ`uid`è¯·æ±‚ä¸åŒçš„æ¥å£:

```java
   @Override
    protected Observable<Timeline> buildObservable() {
        switch (timeline_type) {
            case "home_timeline":
                return mRepository.home_timeline(page, feature)
                        .compose(mSchedulerTransformer);
            case "friends_timeline":
         	    skip;
            default:
                return Observable.error(new Throwable("Timeline type can't be null!"));
        }
```

ç„¶ååœ¨`GetTimelineUsecase`ä¸­ä¼šæœ‰ä¸€ä¸ª`excute()`æ–¹æ³•,æˆ‘åœ¨è¿™é‡Œå¤„ç†ä¸šåŠ¡é€»è¾‘:

```java
public Observable<Timeline> excute(final boolean refresh) {
    return buildObservable()
            .doOnSubscribe(new Action0() {
                @Override
                public void call() {
                    if (refresh) {
                        page = 1;
                    }
                }
            })
            .doOnNext(new Action1<Timeline>() {
                @Override
                public void call(Timeline timeline) {
                    if (0 != timeline.getNextCursor()) {
                        ++page;
                    }
                }
            });
}
```

ç„¶åä½ ä¼šé—®ä¸šåŠ¡é€»è¾‘åœ¨å“ªé‡Œ...

> é»‘äººé—®å·???

æˆ‘å°±è¯´å˜›,ä¸€èˆ¬çš„é¡¹ç›®æ²¡ä»€ä¹ˆä¸šåŠ¡é€»è¾‘....

è¿™é‡Œä¸æ˜¯æœ‰ä¸€ç‚¹ç‚¹å¤„ç†åˆ†é¡µçš„é€»è¾‘(å°±è¿™ä¹ˆå¤šäº†

æ‰€ä»¥Viewå±‚(æˆ–è€…è¯´æ˜¯ä½ çš„Presenter)ä¸ç”¨å†å…³å¿ƒåˆ†é¡µ,ä¸ç”¨æœ‰ä»€ä¹ˆpageæˆ–è€…cursor

åªè¦åœ¨é‚£è¾¹ä¸€ç›´è°ƒç”¨`excute()`å°±å¥½äº†

> æƒ³åˆ°ä¸€ä¸ªViewå±‚çš„è®¾è®¡åŸåˆ™:è®©Viewå°½å¯èƒ½çš„ç¬¨æ‹™å’Œè¢«åŠ¨

è™½ç„¶ä¼šä¼ è¿‡æ¥ä¸€ä¸ª`refresh`çš„`Boolean`å€¼å“ˆ,ä½†æ˜¯å¯ä»¥è®¤ä¸ºè¿™åªæ˜¯ç”¨æˆ·æ“ä½œ(é¡µé¢é€»è¾‘),å’Œä¸šåŠ¡é€»è¾‘æ— å…³.



**PS:**

åœ¨è¿™é‡Œè¿˜è‡ªå®šä¹‰äº†ä¸€ä¸ªæ³¨è§£

```java
@Documented
@Retention(CLASS)
@Target({METHOD, PARAMETER, FIELD})
public @interface Nullable {
}
```

>  å› ä¸ºè¿™ä¸ªmoduleæ²¡æœ‰`support-annotation`å¯ä»¥ç”¨

Daggerä¼šè¦æ±‚å¦‚æœä½ æ³¨å…¥çš„å‚æ•°æ˜¯`null`,å°±å¿…é¡»ç”¨`@Nullable`æ³¨è§£,ä¸ç„¶å°±ä¼šæŠ¥é”™.

åœ¨ä¸€äº›åœ°æ–¹æˆ‘éœ€è¦ç”¨åˆ°å®ƒ,æ¥ä¼ å…¥ä¸€äº›é»˜è®¤å€¼(æ¯”å¦‚nullå’Œ0,å› ä¸ºå¯èƒ½è¿™ä¸ªè¯·æ±‚å‚æ•°ç”¨ä¸åˆ°

å¦å¤–,åœ¨æ³¨å…¥`String` `Long`ç­‰ç±»å‹çš„å‚æ•°çš„æ—¶å€™,éœ€è¦ç”¨`@Name`æ³¨è§£,ä¸ç„¶ç¼–è¯‘å™¨è‚¯å®šä¸çŸ¥é“ä½ éœ€è¦çš„æ˜¯ä»€ä¹ˆ



**Viewå±‚**

Viewå±‚å…¶å®æ²¡ä»€ä¹ˆå¥½è®²çš„,å°±æ˜¯Databinding+Dagger+MVP

**Dagger:**

**MVP:**

åŸºæœ¬ä¸Šæ˜¯ç…§ç€goggleå†™å‡ºæ¥çš„ 

æœ‰å¾ˆå¤šåˆ†æè¿™å‡ ä¸ªé¡¹ç›®çš„ä¸é”™çš„æ–‡ç« ,æˆ‘ä¹Ÿæ˜¯çœ‹äº†å¥½ä¹…æ‰ææ¸…æ¥šçš„

è¿™é‡Œå°±ä¸å±•å¼€äº†â€¦å…·ä½“çš„å¯ä»¥çœ‹çœ‹æˆ‘çš„ä»£ç 

> é“¾æ¥å‘¢



**DataBinding**

å…¶å®ç”¨äº†ä¹‹åæ„Ÿè§‰æ²¡æœ‰ä¸€å¼€å§‹é‚£ä¹ˆé…·ç‚«å•¦

åŒå‘ç»‘å®šä»€ä¹ˆçš„,å®é™…ä½¿ç”¨åœºæ™¯å¾ˆå°‘...

è€Œä¸”cleanç»“æ„å†³å®šäº†Viewå’ŒçœŸæ­£çš„Modelåªä¼šæ˜¯å•å‘çš„ç»‘å®š



å¦‚æœä½ è¿˜æ²¡ç”¨è¿‡DataBinding,èµ¶ç´§å°è¯•å§

å…¶å®googleçš„æ–‡æ¡£å†™çš„ä¸æ˜¯å¾ˆå…¨é¢,æœ€å—ç”¨çš„è¿˜æ˜¯å¤§å¸…çš„åšå®¢:

> æœºæ™º



**ViewModel:**

æ—¢ç„¶æ˜¯å•å‘ç»‘å®š,ViewModelæ‰®æ¼”çš„è§’è‰²å°±åªæ˜¯

- æš´éœ²å‡ºéœ€è¦çš„properties
- è®©Viewå®ç°å®ƒçš„æ¥å£

å½“ç„¶å…³äºViewModelçš„å†™æ³•,è®²é“ç†åº”è¯¥æ˜¯å¯¹dataå±‚çš„modelçš„ä¸€æ¬¡æ˜ å°„,

ä½†æ˜¯æ„Ÿè§‰è¿™æ ·è¦ç”¨æ‰‹æ‰“å¥½å¤šä»£ç ...å¦‚æœASæœ‰æ’ä»¶(ç±»ä¼¼GsonFormatä¹‹ç±»çš„)æˆ‘å¯èƒ½ä¼šè¿™æ ·å†™...

æ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬ç›´æ¥`extends`æˆ–è€…`wrap`æŸä¸ªmodelå°±å¥½äº†â€¦å†è°ƒç”¨`getter`æ–¹æ³•è·å¾—properties



**Tips**

å…¶å®ç”¨ViewModelçš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°è£…ä¸€äº›æ–¹æ³•.

æ¯”å¦‚å›¾ç‰‡åŠ è½½åº“...ä½ å¯èƒ½ä¼šè§‰å¾—å›¾ç‰‡åŠ è½½åº“è¿˜è¦å°è£…,ä¸æ˜¯åªè¦ä¸€å¥è¯:

```java
load(url).into(imageView);
```

å¯¹å•Š,ä½†æ˜¯å¯èƒ½ä½ å› ä¸ºGlideçš„æ–¹æ³•æ•°å¤ªå¤š,è¦æ¢æˆPicasso,è¿™ä¸‹å°±éº»çƒ¦äº†

ä½†æ˜¯å½“ä½ æŠŠæ‰€æœ‰å›¾ç‰‡åŠ è½½çš„åœºæ™¯(ç®€å•çš„...)éƒ½å†™åœ¨`@BindingAdapter`é‡Œé¢

ä¸¾ä¸ªğŸŒ°:

```java
    @BindingAdapter("avatar")
    public static void loadAvatar(ImageView view, String url) {
        Glide.with(view.getContext()).load(url).into(view);
    }

    @BindingAdapter("photo")
    public static void loadPhoto(ImageView view, String uri) {
        Glide.with(view.getContext()).load(Uri.parse(uri)).into(view);
    }
```

è¿™æ ·åˆ°æ—¶å€™æ›´æ¢ä¸€ä¸ªåº“å°±å¾ˆæ–¹ä¾¿äº†



**Rxjava**

ç”¨`Subscriber`æ¥ä»£æ›¿`Callback`,åœ¨Presenteré‡Œé¢å°±å…¨éƒ¨éƒ½æ˜¯ä»ä¸Šå¾€ä¸‹çš„Rxçš„stream

æ¯”å¦‚ä¸€ä¸ªåˆ—è¡¨åŠ è½½æ•°æ®

ä¸¾ä¸ªğŸŒ°

```java
	public void loadMore() {
        if (dataInTransit || reachBottom) return;
        mSubscriptions.add(mUsecase.execute(false) // boolean: needRefresh
                .doOnSubscribe(() -> dataInTransit = true)
                .doOnTerminate(() -> dataInTransit = false)
                .doOnSubscribe(mView::startLoading)
                .doOnTerminate(mView::stopLoading)
                .doOnError(mView::showError)
                .subscribe(timeline -> {
                    if (timeline.getNextCursor() == 0) {
                        reachBottom = true;
                        mView.showNoMore();
                    } else {
                        mView.setData(timeline.getStatuses(), false);
                    }
                }));
    }
```

å†™èµ·æ¥ç‰¹åˆ«èˆ’æœ~























å…³äºå…¶ä»–çš„ä¸œè¥¿ æˆ‘æ„Ÿè§‰çœŸçš„æ²¡ä»€ä¹ˆå¥½è®²çš„...

åˆ†äº«ä¸€äº›ä»Šå¹´,è¯´ä»Šå¹´æ„Ÿè§‰å¤ªè¿œäº†....åæ­£å°±æ˜¯é™†é™†ç»­ç»­çœ‹è¿‡çš„æ–‡ç« å§





å…³äºEventBus

ä¹‹å‰åœ¨ç”¨è¿‡ä¸€æ®µæ—¶é—´EventBusä¹‹åä¸€ç›´å¾ˆå…‹åˆ¶åœ°ä½¿ç”¨å®ƒ

å› ä¸ºæ„Ÿè§‰ä»£ç é‡ä¸€ä¸Šå»,å„ç§Eventä¼šè®©é€»è¾‘å˜å¾—å¾ˆæ··ä¹±

ç°åœ¨å‘ç°äº†é€‚åˆå‘é€æ¶ˆæ¯çš„åº”è¯¥æ˜¯ä¸€äº›å…¨å±€äº‹ä»¶,å…¶ä»–ä¸€äº›è€¦åˆåº¦å¾ˆé«˜çš„å¯ä»¥ç›´æ¥ç”¨æ™®é€šçš„Observableæ¨¡å¼æ¥å®ç°.



æ¯”å¦‚è¯´ä½ åˆ é™¤ä¸€ä¸ªè¯„è®º,å‘é€ä¸€ä¸ªPostCommentEvent é‚£ä¹ˆå°±åº”è¯¥è®©

æ‰€æœ‰å’Œcommentæœ‰å…³çš„é¡µé¢éƒ½è®¢é˜…è¿™ä¸ªäº‹ä»¶

æˆ‘å¼€å§‹åœ¨ä¸€ä¸ªEventç±»é‡Œé¢å†™æ³¨é‡Š:

å¤‡æ³¨ä¸‹åˆ°åº•è¿™ä¸ªäº‹ä»¶å‘é€ä¹‹ååº”è¯¥æˆ–è€…æˆ–è€…å½±å“åˆ°å“ªäº›é¡µé¢





æˆ‘ä»¬å¤ªç©·äº† ä¹°ä¸èµ·æœåŠ¡å™¨...

æˆ‘å¼€å§‹åœ¨æ¯ä¸€æ­¥è¦è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ—¶å€™éƒ½å¼€å§‹è§£å†³appçš„å¼€é”€

æˆ‘ä¸å†åˆ·æ–°ç•Œé¢

æ‰€è§ä¸ä¸€å®šæ˜¯æ‰€å¾—









